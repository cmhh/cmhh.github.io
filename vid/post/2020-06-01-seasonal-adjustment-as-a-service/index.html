<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>cmhh  | Seasonal Adjustment as a Service</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
    <link href="../../css/highlight/atom-one-dark-reasonable.css" rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="../../css/blog.css" />
    <link rel="stylesheet" href="../../css/custom.css" />
</head>
<body>

    
    <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="../../">Home</a>
            
        </div>
    </nav>
    

    
    <section class="hero is-info is-medium">
        <div class="hero-body" style="background-image: url(/img/bg-blog-2.jpg);">
            <div class="container has-text-centered">
                <br>
                <h1 class="title is-size-1">
                    
                        Seasonal Adjustment as a Service
                    
                </h1>
                
            </div>
        </div>
    </section>


<div class="container">
    <div class="section">
    

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                <h1 id="overview">Overview</h1>
<p><a href="https://www.census.gov/srd/www/x13as/" target="_blank">X13-ARIMA-SEATS</a> is a widely used seasonal adjustment program developed by the <a href="https://www.census.gov/" target="_blank">United States Census Bureau</a>.  It&rsquo;s a command-line tool, and I&rsquo;ve wondered whether it would be useful to run as a web serviceâ€“where I work, the standard security model makes running command-line tools a little problematic, so running a single service that could be accessed by any other client remotely would seem, on the face of it, a useful proposition.</p>
<h1 id="a-simple-example">A Simple Example&hellip;</h1>
<p>The X13 binary ships with a relatively simple example using the famous Box and Jenkins air passengers data.  That is, a simple specification is provided in a file called <code>testairline.spc</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">series{
  title=&#34;International Airline Passengers Data from Box and Jenkins&#34;
  start=1949.01
  data=(
	112 118 132 129 121 135 148 148 136 119 104 118
	115 126 141 135 125 149 170 170 158 133 114 140
	145 150 178 163 172 178 199 199 184 162 146 166
	171 180 193 181 183 218 230 242 209 191 172 194
	196 196 236 235 229 243 264 272 237 211 180 201
	204 188 235 227 234 264 302 293 259 229 203 229
	242 233 267 269 270 315 364 347 312 274 237 278
	284 277 317 313 318 374 413 405 355 306 271 306
	315 301 356 348 355 422 465 467 404 347 305 336
	340 318 362 348 363 435 491 505 404 359 310 337
	360 342 406 396 420 472 548 559 463 407 362 405
	417 391 419 461 472 535 622 606 508 461 390 432)
  span=(1952.01, )
}
spectrum{
  savelog=peaks	
}
transform{
  function=auto
  savelog=autotransform  
}
regression{
  aictest=(td easter)
  savelog=aictest  
}
automdl{  
  savelog=automodel  
}
outlier{ }
x11{}
</code></pre></div><p>One could adjust this at the command line by running something like (there are a number of ways the program can be invoked):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">x13ashtml testairline -g g
</code></pre></div><p>Adding the <code>g</code> flag with value <code>g</code> tells X13 we wish to save output to subdirectory <code>g</code>, and we will end up with a number of text files matching the pattern <code>g/testairline.*</code>.  For example, a range of diagnostics will be written as key-value pairs in a file called <code>g/testairline.udg</code>, the first few lines of which would look similar to:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">date: Jun  1, 2020  
time: 14.19.08 
version: 1.1
build: 39
output: html
srstit: International Airline Passengers Data from Box and Jenkins
srsnam: testairline                                                     
freq:    12
span:  1st month,1952 to 12th month,1960
nobs:   108
constant:     0.0000000000E+00
transform: Automatic selection
...
</code></pre></div><p>The seasonally adjusted and trend series would be saved as <code>g/testairline.d11</code> and <code>g/tsairline.d12</code>, respectively, and the first few rows of the D11 table would look as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">date    testairline.d11
------  -----------------------
195201  +0.192925972176234E+03
195202  +0.198588812698691E+03
195203  +0.185791217572829E+03
195204  +0.185841707777349E+03
195205  +0.186173988743725E+03
195206  +0.192599054707605E+03
195207  +0.187601439031062E+03
195208  +0.200184926772685E+03
...
</code></pre></div><h1 id="as-a-service">&hellip;as a Service</h1>
<p>I created a <a href="https://github.com/cmhh/seasadj">basic library</a> which can be used to run X13 programmatically on the JVM (the library is written in Scala), and also as a web service (the web service itself is written using Akka HTTP).  The above test specification would be converted to JSON in somewhat obvious fashion as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;airpassengers&#34;</span>:{
    <span style="color:#f92672">&#34;series&#34;</span>:{
      <span style="color:#f92672">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;International Airline Passengers Data from Box and Jenkins&#34;</span>,
      <span style="color:#f92672">&#34;start&#34;</span>:<span style="color:#e6db74">&#34;1949.01&#34;</span>,
      <span style="color:#f92672">&#34;data&#34;</span>:[
        <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">129</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">118</span>,
        <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">126</span>, <span style="color:#ae81ff">141</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">125</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">170</span>, <span style="color:#ae81ff">170</span>, <span style="color:#ae81ff">158</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">140</span>,
        <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">199</span>, <span style="color:#ae81ff">199</span>, <span style="color:#ae81ff">184</span>, <span style="color:#ae81ff">162</span>, <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">166</span>,
        <span style="color:#ae81ff">171</span>, <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">193</span>, <span style="color:#ae81ff">181</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">218</span>, <span style="color:#ae81ff">230</span>, <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">209</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">194</span>,
        <span style="color:#ae81ff">196</span>, <span style="color:#ae81ff">196</span>, <span style="color:#ae81ff">236</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">229</span>, <span style="color:#ae81ff">243</span>, <span style="color:#ae81ff">264</span>, <span style="color:#ae81ff">272</span>, <span style="color:#ae81ff">237</span>, <span style="color:#ae81ff">211</span>, <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">201</span>,
        <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">234</span>, <span style="color:#ae81ff">264</span>, <span style="color:#ae81ff">302</span>, <span style="color:#ae81ff">293</span>, <span style="color:#ae81ff">259</span>, <span style="color:#ae81ff">229</span>, <span style="color:#ae81ff">203</span>, <span style="color:#ae81ff">229</span>,
        <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">233</span>, <span style="color:#ae81ff">267</span>, <span style="color:#ae81ff">269</span>, <span style="color:#ae81ff">270</span>, <span style="color:#ae81ff">315</span>, <span style="color:#ae81ff">364</span>, <span style="color:#ae81ff">347</span>, <span style="color:#ae81ff">312</span>, <span style="color:#ae81ff">274</span>, <span style="color:#ae81ff">237</span>, <span style="color:#ae81ff">278</span>,
        <span style="color:#ae81ff">284</span>, <span style="color:#ae81ff">277</span>, <span style="color:#ae81ff">317</span>, <span style="color:#ae81ff">313</span>, <span style="color:#ae81ff">318</span>, <span style="color:#ae81ff">374</span>, <span style="color:#ae81ff">413</span>, <span style="color:#ae81ff">405</span>, <span style="color:#ae81ff">355</span>, <span style="color:#ae81ff">306</span>, <span style="color:#ae81ff">271</span>, <span style="color:#ae81ff">306</span>,
        <span style="color:#ae81ff">315</span>, <span style="color:#ae81ff">301</span>, <span style="color:#ae81ff">356</span>, <span style="color:#ae81ff">348</span>, <span style="color:#ae81ff">355</span>, <span style="color:#ae81ff">422</span>, <span style="color:#ae81ff">465</span>, <span style="color:#ae81ff">467</span>, <span style="color:#ae81ff">404</span>, <span style="color:#ae81ff">347</span>, <span style="color:#ae81ff">305</span>, <span style="color:#ae81ff">336</span>,
        <span style="color:#ae81ff">340</span>, <span style="color:#ae81ff">318</span>, <span style="color:#ae81ff">362</span>, <span style="color:#ae81ff">348</span>, <span style="color:#ae81ff">363</span>, <span style="color:#ae81ff">435</span>, <span style="color:#ae81ff">491</span>, <span style="color:#ae81ff">505</span>, <span style="color:#ae81ff">404</span>, <span style="color:#ae81ff">359</span>, <span style="color:#ae81ff">310</span>, <span style="color:#ae81ff">337</span>,
        <span style="color:#ae81ff">360</span>, <span style="color:#ae81ff">342</span>, <span style="color:#ae81ff">406</span>, <span style="color:#ae81ff">396</span>, <span style="color:#ae81ff">420</span>, <span style="color:#ae81ff">472</span>, <span style="color:#ae81ff">548</span>, <span style="color:#ae81ff">559</span>, <span style="color:#ae81ff">463</span>, <span style="color:#ae81ff">407</span>, <span style="color:#ae81ff">362</span>, <span style="color:#ae81ff">405</span>,
        <span style="color:#ae81ff">417</span>, <span style="color:#ae81ff">391</span>, <span style="color:#ae81ff">419</span>, <span style="color:#ae81ff">461</span>, <span style="color:#ae81ff">472</span>, <span style="color:#ae81ff">535</span>, <span style="color:#ae81ff">622</span>, <span style="color:#ae81ff">606</span>, <span style="color:#ae81ff">508</span>, <span style="color:#ae81ff">461</span>, <span style="color:#ae81ff">390</span>, <span style="color:#ae81ff">432</span>
      ],
      <span style="color:#f92672">&#34;span&#34;</span>:[<span style="color:#e6db74">&#34;1952.01&#34;</span>, <span style="color:#66d9ef">null</span>]
    },
    <span style="color:#f92672">&#34;spectrum&#34;</span>:{
      <span style="color:#f92672">&#34;savelog&#34;</span>:<span style="color:#e6db74">&#34;peaks&#34;</span>
    },
    <span style="color:#f92672">&#34;transform&#34;</span>:{
      <span style="color:#f92672">&#34;function&#34;</span>:<span style="color:#e6db74">&#34;auto&#34;</span>,
      <span style="color:#f92672">&#34;savelog&#34;</span>:<span style="color:#e6db74">&#34;autotransform&#34;</span>
    },
    <span style="color:#f92672">&#34;regression&#34;</span>:{
      <span style="color:#f92672">&#34;aictest&#34;</span>:[<span style="color:#e6db74">&#34;td&#34;</span>, <span style="color:#e6db74">&#34;easter&#34;</span>],
      <span style="color:#f92672">&#34;savelog&#34;</span>:<span style="color:#e6db74">&#34;aictest&#34;</span>  
    },
    <span style="color:#f92672">&#34;automdl&#34;</span>:{
      <span style="color:#f92672">&#34;savelog&#34;</span>:<span style="color:#e6db74">&#34;automodel&#34;</span>
    },
    <span style="color:#f92672">&#34;outlier&#34;</span>:<span style="color:#66d9ef">null</span>,
    <span style="color:#f92672">&#34;x11&#34;</span>:<span style="color:#66d9ef">null</span>
  }
}
</code></pre></div><p>If this was saved as <code>testairline.json</code>, and a service instance was running at <code>localhost:9001</code>, then the adjustment could be run via curl, say, as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -X POST <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -d @testairline.json <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  localhost:9001/seasadj/adjust <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --compressed --output testairline_output.json
</code></pre></div><p>The resulting JSON file contains most of the X13 output where files that can be imported as time series are saved in an array called <code>series</code>, and the diagnostics are parsed into an array called <code>diagnostics</code>.</p>
<p><img src="assets/postman01.png" alt="POST"></p>
<p>Note that more than a single series can be included in a single JSON file / string in a fairly obvious way, and the use of composites is permitted.  Moreover, because the full set of results can get somewhat large, it is possible to edit the results.  For example, if we only wished to keep the seasonally adjusted and trend time series output we could append the query parameter <code>save=sa,trn</code>; and if we wanted to suppress all the dates and just include the start date and frequency we could append <code>allDates=false</code>.</p>
<h1 id="a-basic-javascript-client">A Basic JavaScript &lsquo;Client&rsquo;</h1>
<p>Of course, once we have a web service, we can call it from any language or tool that has the ability to POST and parse JSON, which is pretty much everything.  Client libraries could then be written for various target languages, if required, allowing users to use the service easily, and in an idiomatic way.  One fun example involves calling the service in the browser using JavaScript.  I like the idea of making component libraries using a framework such as <a href="https://vuejs.org/">Vue.js</a>, and this could be done here.  In the following example we create a simple Vue.js component which knows how to fetch an unadjusted time series by ID using a <a href="https://github.com/cmhh/snzts">service I created earlier</a>, adjust the result, and then populate a <a href="https://www.highcharts.com/">highchart</a>:</p>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
<script src="https://code.highcharts.com/highcharts.src.js"></script>
<div class=framed><div id=app></div></div>
<script>
Vue.component('snzseasadjchart', {
  props: {
    name: {required: true},
    code: { required: true }
  },
  data: function() {
    return {
      tsdata: {}
    }
  },
  mounted() {
    this.$_update(this.code);
  },
  watch: {
    code() {
      this.$_update(this.code);
    },
    tsdata() {
      Highcharts.chart(this.name, {
        title: {
          text: this.tsdata.title,
          useHTML: true
        },
        yAxis: {
          title: {
            text: this.tsdata.units
          }
        },
        xAxis: {
          categories: this.tsdata.period
        },
        series: [
          {
            name: "unadjusted",
            data: this.tsdata.ori
          },
          {
            name: "seasonally adjusted",
            data: this.tsdata.sa
          },
          {
            name: "trend",
            data: this.tsdata.trn
          }
        ],
        chart: {
          type: 'line',
          zoomType: 'xy',
          height: null
        },
        plotOptions: {
          series: {
            allowPointSelect: true,
            marker: {
              enabled: false
            }
          }
        },
        credits: {
          enabled: true,
          href: "https://www.stats.govt.nz/large-datasets/csv-files-for-download/",
          text: "Stats NZ"
        }
      });
    }
  },
  methods: {
    $_update(seriesCode) {
      let context = this;
      axios
        .get(`https://cmhh.hopto.org/snzts/v1/series?format=json&seriesCode=${this.code}`)
        .then(response => {
          let actual = response.data[0];
          let title = actual.outcomes.join(", ");
          let start = actual.period[0];
          let data = actual.value.toString();
          let period = 12 / actual.interval;
          let units = actual.units;
          let magnitude = actual.magnitude;
          let request = 
            `{"x":{"series":{"title":"${title}","start":"${start}",` +
            `"period":${period},"data":[${data}]},"x11":null}}`;
          axios
            .post("https://cmhh.hopto.org/seasadj/adjust?save=ori,sa,trn", request)
            .then(response => {
              let res = response.data.x;
              context.tsdata = {
                title:title,
                units:units,
                magnitude:magnitude,
                period:res.series.ori.date,
                ori:res.series.ori.value,
                sa:res.series.sa.value,
                trn:res.series.trn.value
              };
            });
        });
    }
  },
  template: `<div class="snztschart" v-bind:id="name"></div>`
});
</script>
<script>
let app = new Vue({
  el: '#app',
  data() {
    return {
      code: "HLFQ.SAA3AZ"
    }
  },
  template:`
    <div>
      <label for="cars">Choose a series:</label>
      <select v-model="code">
        <option value="HLFQ.SAA3AZ" selected>total employed</option>
        <option value="HLFQ.SAB3AZ">total unemployed</option>
        <option value="HLFQ.SAC3AZ">not in labour force</option>
        <option value="HLFQ.SAE3AZ">labour force participation rate</option>
        <option value="HLFQ.SAH3AZ">employment rate</option>
        <option value="HLFQ.SAF3AZ">unemployment rate</option>
        <option value="HLFQ.SAD3AZ">working-age population</option>
      </select>
      <hr>
      <snzseasadjchart v-bind:code="code" name=ts02></snzseasadjchart>
    </div>
  `
});
</script>
<p>For those interested, the full source of this &lsquo;application&rsquo; is as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://unpkg.com/axios/dist/axios.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/vue@2.6.11&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://code.highcharts.com/highcharts.src.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">app</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
&lt;<span style="color:#f92672">script</span>&gt;
<span style="color:#a6e22e">Vue</span>.<span style="color:#a6e22e">component</span>(<span style="color:#e6db74">&#39;snzseasadjchart&#39;</span>, {
  <span style="color:#a6e22e">props</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">required</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>},
    <span style="color:#a6e22e">code</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">required</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> }
  },
  <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">return</span> {
      <span style="color:#a6e22e">tsdata</span><span style="color:#f92672">:</span> {}
    }
  },
  <span style="color:#a6e22e">mounted</span>() {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">$_update</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">code</span>);
  },
  <span style="color:#a6e22e">watch</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">code</span>() {
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">$_update</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">code</span>);
    },
    <span style="color:#a6e22e">tsdata</span>() {
      <span style="color:#a6e22e">Highcharts</span>.<span style="color:#a6e22e">chart</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span>, {
        <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">title</span>,
          <span style="color:#a6e22e">useHTML</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
        },
        <span style="color:#a6e22e">yAxis</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> {
            <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">units</span>
          }
        },
        <span style="color:#a6e22e">xAxis</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">categories</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">period</span>
        },
        <span style="color:#a6e22e">series</span><span style="color:#f92672">:</span> [
          {
            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;unadjusted&#34;</span>,
            <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">ori</span>
          },
          {
            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;seasonally adjusted&#34;</span>,
            <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">sa</span>
          },
          {
            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;trend&#34;</span>,
            <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">tsdata</span>.<span style="color:#a6e22e">trn</span>
          }
        ],
        <span style="color:#a6e22e">chart</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;line&#39;</span>,
          <span style="color:#a6e22e">zoomType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;xy&#39;</span>,
          <span style="color:#a6e22e">height</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">null</span>
        },
        <span style="color:#a6e22e">plotOptions</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">series</span><span style="color:#f92672">:</span> {
            <span style="color:#a6e22e">allowPointSelect</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
            <span style="color:#a6e22e">marker</span><span style="color:#f92672">:</span> {
              <span style="color:#a6e22e">enabled</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>
            }
          }
        },
        <span style="color:#a6e22e">credits</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">enabled</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
          <span style="color:#a6e22e">href</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.stats.govt.nz/large-datasets/csv-files-for-download/&#34;</span>,
          <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Stats NZ&#34;</span>
        }
      });
    }
  },
  <span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">$_update</span>(<span style="color:#a6e22e">seriesCode</span>) {
      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">context</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>;
      <span style="color:#a6e22e">axios</span>
        .<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">`https://cmhh.hopto.org/snzts/v1/series?format=json&amp;seriesCode=</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">code</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
        .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; {
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">actual</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>[<span style="color:#ae81ff">0</span>];
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">outcomes</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;, &#34;</span>);
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">start</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">period</span>[<span style="color:#ae81ff">0</span>];
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">toString</span>();
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">period</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">interval</span>;
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">units</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">units</span>;
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">magnitude</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">actual</span>.<span style="color:#a6e22e">magnitude</span>;
          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> 
            <span style="color:#e6db74">`{&#34;x&#34;:{&#34;series&#34;:{&#34;title&#34;:&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">title</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,&#34;start&#34;:&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">start</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,`</span> <span style="color:#f92672">+</span>
            <span style="color:#e6db74">`&#34;period&#34;:</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">period</span><span style="color:#e6db74">}</span><span style="color:#e6db74">,&#34;data&#34;:[</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">data</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]},&#34;x11&#34;:null}}`</span>;
          <span style="color:#a6e22e">axios</span>
            .<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#34;https://cmhh.hopto.org/seasadj/adjust?save=ori,sa,trn&#34;</span>, <span style="color:#a6e22e">request</span>)
            .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; {
              <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">x</span>;
              <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">tsdata</span> <span style="color:#f92672">=</span> {
                <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span><span style="color:#a6e22e">title</span>,
                <span style="color:#a6e22e">units</span><span style="color:#f92672">:</span><span style="color:#a6e22e">units</span>,
                <span style="color:#a6e22e">magnitude</span><span style="color:#f92672">:</span><span style="color:#a6e22e">magnitude</span>,
                <span style="color:#a6e22e">period</span><span style="color:#f92672">:</span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">series</span>.<span style="color:#a6e22e">ori</span>.<span style="color:#a6e22e">date</span>,
                <span style="color:#a6e22e">ori</span><span style="color:#f92672">:</span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">series</span>.<span style="color:#a6e22e">ori</span>.<span style="color:#a6e22e">value</span>,
                <span style="color:#a6e22e">sa</span><span style="color:#f92672">:</span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">series</span>.<span style="color:#a6e22e">sa</span>.<span style="color:#a6e22e">value</span>,
                <span style="color:#a6e22e">trn</span><span style="color:#f92672">:</span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">series</span>.<span style="color:#a6e22e">trn</span>.<span style="color:#a6e22e">value</span>
              };
            });
        });
    }
  },
  <span style="color:#a6e22e">template</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`&lt;div class=&#34;snztschart&#34; v-bind:id=&#34;name&#34;&gt;&lt;/div&gt;`</span>
});
&lt;/<span style="color:#f92672">script</span>&gt;
&lt;<span style="color:#f92672">script</span>&gt;
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Vue</span>({
  <span style="color:#a6e22e">el</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;#app&#39;</span>,
  <span style="color:#a6e22e">data</span>() {
    <span style="color:#66d9ef">return</span> {
      <span style="color:#a6e22e">code</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HLFQ.SAA3AZ&#34;</span>
    }
  },
  <span style="color:#a6e22e">template</span><span style="color:#f92672">:</span><span style="color:#e6db74">`
</span><span style="color:#e6db74">    &lt;div&gt;
</span><span style="color:#e6db74">      &lt;label for=&#34;cars&#34;&gt;Choose a series:&lt;/label&gt;
</span><span style="color:#e6db74">      &lt;select v-model=&#34;code&#34;&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAA3AZ&#34; selected&gt;total employed&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAB3AZ&#34;&gt;total unemployed&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAC3AZ&#34;&gt;not in labour force&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAE3AZ&#34;&gt;labour force participation rate&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAH3AZ&#34;&gt;employment rate&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAF3AZ&#34;&gt;unemployment rate&lt;/option&gt;
</span><span style="color:#e6db74">        &lt;option value=&#34;HLFQ.SAD3AZ&#34;&gt;working-age population&lt;/option&gt;
</span><span style="color:#e6db74">      &lt;/select&gt;
</span><span style="color:#e6db74">      &lt;hr&gt;
</span><span style="color:#e6db74">      &lt;snzseasadjchart v-bind:code=&#34;code&#34; name=ts02&gt;&lt;/snzseasadjchart&gt;
</span><span style="color:#e6db74">    &lt;/div&gt;
</span><span style="color:#e6db74">  `</span>
});
&lt;/<span style="color:#f92672">script</span>&gt;
</code></pre></div>
            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="../../tags/akka-http">akka-http</a></span>
        
            <span class="tag"><a href="../../tags/docker">docker</a></span>
        
            <span class="tag"><a href="../../tags/geoserver">geoserver</a></span>
        
            <span class="tag"><a href="../../tags/geospark">geospark</a></span>
        
            <span class="tag"><a href="../../tags/geospatial">geospatial</a></span>
        
            <span class="tag"><a href="../../tags/nodejs">nodejs</a></span>
        
            <span class="tag"><a href="../../tags/osrm">osrm</a></span>
        
            <span class="tag"><a href="../../tags/postgis">postgis</a></span>
        
            <span class="tag"><a href="../../tags/postgresql">postgresql</a></span>
        
            <span class="tag"><a href="../../tags/qgis">qgis</a></span>
        
            <span class="tag"><a href="../../tags/r">r</a></span>
        
            <span class="tag"><a href="../../tags/r-packages">r-packages</a></span>
        
            <span class="tag"><a href="../../tags/seasonal-adjustment">seasonal-adjustment</a></span>
        
            <span class="tag"><a href="../../tags/sedona">sedona</a></span>
        
            <span class="tag"><a href="../../tags/shiny">shiny</a></span>
        
            <span class="tag"><a href="../../tags/spark">spark</a></span>
        
            <span class="tag"><a href="../../tags/tiles">tiles</a></span>
        
            <span class="tag"><a href="../../tags/tilestache">tilestache</a></span>
        
            <span class="tag"><a href="../../tags/vuejs">vuejs</a></span>
        
            <span class="tag"><a href="../../tags/wmts">wmts</a></span>
        
            <span class="tag"><a href="../../tags/wsl2">wsl2</a></span>
        
            <span class="tag"><a href="../../tags/x13-arima-seats">x13-arima-seats</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="../../post/2021-07-16-online-learning-with-apache-kafka/">Online Learning with Apache Kafka</a></h1>
            <time class="has-text-grey-light is-size-7">16 July 2021</time>
        
            <h1><a href="../../post/2021-04-19-a-brief-look-at-apache-sedona/">A Brief Look at Apache Sedona</a></h1>
            <time class="has-text-grey-light is-size-7">19 April 2021</time>
        
            <h1><a href="../../post/2020-12-05-working-productively-on-windows-using-wsl2-and-docker/">Working Productively on Windows Using Windows Subsystem for Linux 2 and Docker</a></h1>
            <time class="has-text-grey-light is-size-7">5 December 2020</time>
        
            <h1><a href="../../post/2020-10-31-using-postgis-as-a-spatial-backend-for-r/">Using PostGIS as a Spatial Backend for R</a></h1>
            <time class="has-text-grey-light is-size-7">31 October 2020</time>
        
            <h1><a href="../../post/2020-10-31-docker-on-windows-with-wsl2/">Docker on Windows with Windows Subsystem for Linux 2</a></h1>
            <time class="has-text-grey-light is-size-7">31 October 2020</time>
        
    </div>
</div>
    <br>
                


    
<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
            <a href="../../archives/2021">2021</a> (2)<br>
        
            <a href="../../archives/2020">2020</a> (4)<br>
        
            <a href="../../archives/2019">2019</a> (1)<br>
        
            <a href="../../archives/2017">2017</a> (1)<br>
        
            <a href="../../archives/2016">2016</a> (4)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            <span class="icon is-large"><a href="https://github.com/cmhh" class="mysocial" rel="me"><i class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="mailto://cmhhansen@outlook.com" class="mysocial" rel="me"><i class="fas fa-envelope fa-3x"></i></a></span>&nbsp;&nbsp;
            <br><br>
            Copyright &copy; cmhh 2021 - Theme by <a href="https://jeffprod.com" class="mysocial">JeffProd.com</a>
        </p>
    </div>
</footer>

<script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
<script src="../../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="//yihui.org/js/math-code.js"></script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</body>
</html>
